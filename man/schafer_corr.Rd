% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/schafer_corr.R
\name{schafer_corr}
\alias{schafer_corr}
\alias{print.schafer_corr}
\alias{plot.schafer_corr}
\title{Schäfer-Strimmer shrinkage correlation}
\usage{
schafer_corr(data)

\method{print}{schafer_corr}(x, digits = 3, max_rows = NULL, max_cols = NULL, ...)

\method{plot}{schafer_corr}(
  x,
  title = "Schafer-Strimmer shrinkage correlation heatmap",
  low_color = "indianred1",
  high_color = "steelblue1",
  mid_color = "white",
  value_text_size = 4,
  ...
)
}
\arguments{
\item{data}{A numeric matrix or a data frame with at least two numeric
columns. All non-numeric columns will be excluded. Columns must be numeric
and contain no \code{NA}s.}

\item{x}{An object of class \code{schafer_corr}.}

\item{digits}{Integer; number of decimal places to print.}

\item{max_rows}{Optional integer; maximum number of rows to display.
If \code{NULL}, all rows are shown.}

\item{max_cols}{Optional integer; maximum number of columns to display.
If \code{NULL}, all columns are shown.}

\item{...}{Additional arguments passed to \code{ggplot2::theme()} or other
\code{ggplot2} layers.}

\item{title}{Plot title. Default is
\code{"Schafer-Strimmer shrinkage correlation heatmap"}.}

\item{low_color}{Colour for the minimum correlation. Default is
\code{"indianred1"}.}

\item{high_color}{Colour for the maximum correlation. Default is
\code{"steelblue1"}.}

\item{mid_color}{Colour for zero correlation. Default is \code{"white"}.}

\item{value_text_size}{Font size for correlation values. Default is \code{4}.}
}
\value{
A symmetric numeric matrix of class \code{schafer_corr} where entry
\code{(i, j)} is the shrunk correlation between the \code{i}-th and
\code{j}-th numeric columns. Attributes:
\itemize{
\item \code{method} = \code{"schafer_shrinkage"}
\item \code{description} = \code{"Schäfer-Strimmer shrinkage correlation
  matrix"}
  \item \code{package} = \code{"matrixCorr"}
}
Columns with zero variance are set to \code{NA} across row/column (including
the diagonal), matching \code{pearson_corr()} behaviour.

Invisibly returns \code{x}.

A \code{ggplot} object.
}
\description{
Computes a shrinkage correlation matrix using the Schäfer-Strimmer approach,
with an analytic, data-driven shrinkage intensity \eqn{\hat\lambda}. The
method shrinks off-diagonal correlations towards zero while keeping the
diagonal at one, stabilising estimates when \eqn{p} is large relative to
\eqn{n}.

This function uses a high-performance \code{C++} backend that forms
\eqn{X^\top X} via BLAS \code{SYRK}, applies centring via a rank-1 update,
converts to Pearson correlation, estimates \eqn{\hat\lambda}, and shrinks
the off-diagonals:
\eqn{R_{\mathrm{shr}} = (1-\hat\lambda)R + \hat\lambda I}.

Prints a summary of the shrinkage correlation matrix with
optional truncation for large objects.

Generates a \pkg{ggplot2}-based heatmap of the shrinkage
correlation matrix.
}
\details{
Let \eqn{R} be the sample Pearson correlation matrix. The Schäfer-Strimmer
shrinkage estimator targets the identity in correlation space and uses
\eqn{\hat\lambda = \frac{\sum_{i<j}\widehat{\mathrm{Var}}(r_{ij})}
{\sum_{i<j} r_{ij}^2}} (clamped to \eqn{[0,1]}), where
\eqn{\widehat{\mathrm{Var}}(r_{ij}) \approx \frac{(1-r_{ij}^2)^2}{n-1}}.
The returned estimator is \eqn{R_{\mathrm{shr}} = (1-\hat\lambda)R +
\hat\lambda I}.
}
\note{
No missing values are permitted. Columns with fewer than two observations
or zero variance are flagged as \code{NA} (row/column).
}
\examples{
set.seed(1)
n <- 50; p <- 200
X <- matrix(rnorm(n * p), n, p)
colnames(X) <- paste0("V", seq_len(p))
Rshr <- schafer_corr(X)
print(Rshr, digits = 2, max_rows = 6, max_cols = 6)
\donttest{
  plot(Rshr, title = "Schäfer-Strimmer shrinkage correlation (subset)")
}

}
\references{
Schäfer, J. & Strimmer, K. (2005). A shrinkage approach to large-scale
covariance matrix estimation and implications for functional genomics.
\emph{Statistical Applications in Genetics and Molecular Biology}, 4(1).
}
\seealso{
\code{\link{print.schafer_corr}}, \code{\link{plot.schafer_corr}},
\code{\link{pearson_corr}}
}
\author{
Thiago de Paula Oliveira \email{toliveira@abacusbio.com}
}
