% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kendall_corr.R
\name{kendall_tau}
\alias{kendall_tau}
\alias{print.kendall_matrix}
\alias{plot.kendall_matrix}
\title{Pairwise Kendall's Tau Rank Correlation}
\usage{
kendall_tau(data)

\method{print}{kendall_matrix}(x, digits = 4, max_rows = NULL, max_cols = NULL, ...)

\method{plot}{kendall_matrix}(
  x,
  title = "Kendall's Tau correlation heatmap",
  low_color = "indianred1",
  high_color = "steelblue1",
  mid_color = "white",
  value_text_size = 4,
  ...
)
}
\arguments{
\item{data}{A numeric matrix or a data frame with at least two numeric
columns. All non-numeric columns will be excluded. Each column must have
at least two non-missing values and contain no NAs.}

\item{x}{An object of class \code{kendall_matrix}.}

\item{digits}{Integer; number of decimal places to print}

\item{max_rows}{Optional integer; maximum number of rows to display.
If \code{NULL}, all rows are shown.}

\item{max_cols}{Optional integer; maximum number of columns to display.
If \code{NULL}, all columns are shown.}

\item{...}{Additional arguments passed to \code{ggplot2::theme()} or other
\code{ggplot2} layers.}

\item{title}{Plot title. Default is \code{"Kendall's Tau Correlation
Heatmap"}.}

\item{low_color}{Color for the minimum tau value. Default is
\code{"indianred1"}.}

\item{high_color}{Color for the maximum tau value. Default is
\code{"steelblue1"}.}

\item{mid_color}{Color for zero correlation. Default is \code{"white"}.}

\item{value_text_size}{Font size for displaying correlation values. Default
is \code{4}.}
}
\value{
A symmetric numeric matrix where the \code{(i, j)}-th element is
the Kendall's tau correlation between the \code{i}-th and \code{j}-th
numeric columns of the input.

Invisibly returns the \code{kendall_matrix} object.

A \code{ggplot} object representing the heatmap.
}
\description{
Computes all pairwise Kendall's tau rank correlation coefficients for the
numeric columns of a matrix or data frame using a high-performance
'C++'.

This function uses a fast and scalable algorithm implemented in 'C++'
to compute both Kendall's tau-a (when no ties are present) and tau-b
(when ties are detected), making it suitable for large datasets. It follows
the Knight (1966) \eqn{O(n \log n)} scheme, where a single sort on one
variable, in-block sorting of the paired variable within tie groups, and a
global merge-sort–based inversion count with closed-form tie corrections.

Prints a summary of the Kendall's tau correlation matrix,
including description and method metadata.

Generates a ggplot2-based heatmap of the Kendall's tau
correlation matrix.
}
\details{
Kendall's tau is a rank-based measure of association between two variables.
For a dataset with \eqn{n} observations on variables \eqn{X} and \eqn{Y},
let \eqn{n_0 = n(n - 1)/2} be the number of unordered pairs, \eqn{C} the
number of concordant pairs, and \eqn{D} the number of discordant pairs.
Let \eqn{T_x = \sum_g t_g (t_g - 1)/2} and \eqn{T_y = \sum_h u_h (u_h - 1)/2}
be the numbers of tied pairs within \eqn{X} and within \eqn{Y}, respectively,
where \eqn{t_g} and \eqn{u_h} are tie-group sizes in \eqn{X} and \eqn{Y}.

The tie-robust Kendall's tau-b is defined as:
\deqn{ \tau_b = \frac{C - D}{\sqrt{(n_0 - T_x)\,(n_0 - T_y)}}. }

When there are no ties, the function computes the faster \emph{tau-a}
version:
\deqn{ \tau_a = \frac{C - D}{n(n-1)/2}. }

Note that if \eqn{T_{xy}} denotes the number of pairs tied on both
variables, then pairs partition as \eqn{C + D + T_x + T_y + T_{xy} = n_0}.

The function automatically selects \emph{tau-a} or \emph{tau-b} depending on
the presence of ties. In degenerate cases where a variable is constant
(so \eqn{n_0 = T_x} or \eqn{n_0 = T_y}), the tau-b denominator is zero and
the correlation is undefined (returned as \code{NA}).

Performance is maximised by computing correlations in 'C++' directly from
the matrix columns using the Knight \eqn{O(n \log n)} procedure; columns are
discretised once and pairwise computations are parallelised where available.
}
\note{
Missing values are not allowed. Columns with fewer than two
observations are excluded.
}
\examples{
# Basic usage with a matrix
mat <- cbind(a = rnorm(100), b = rnorm(100), c = rnorm(100))
kt <- kendall_tau(mat)
print(kt)
plot(kt)

# With a large data frame
df <- data.frame(x = rnorm(1e4), y = rnorm(1e4), z = rnorm(1e4))
kendall_tau(df)

# Including ties
tied_df <- data.frame(
  v1 = rep(1:5, each = 20),
  v2 = rep(5:1, each = 20),
  v3 = rnorm(100)
)
kt <- kendall_tau(tied_df)
print(kt)
plot(kt)

}
\references{
Kendall, M. G. (1938). A New Measure of Rank Correlation. \emph{Biometrika},
30(1/2), 81–93.

Knight, W. R. (1966). A Computer Method for Calculating Kendall’s Tau with
Ungrouped Data. \emph{Journal of the American Statistical Association},
61(314), 436–439.
}
\seealso{
\code{\link{print.kendall_matrix}},
\code{\link{print.kendall_matrix}}
}
\author{
Thiago de Paula Oliveira
}
