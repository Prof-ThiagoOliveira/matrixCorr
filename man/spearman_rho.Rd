% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spearman_rho.R
\name{spearman_rho}
\alias{spearman_rho}
\alias{print.spearman_rho}
\alias{plot.spearman_rho}
\title{Fast pairwise Spearman's rank correlation}
\usage{
spearman_rho(data)

\method{print}{spearman_rho}(x, digits = 3, max_rows = NULL, max_cols = NULL, ...)

\method{plot}{spearman_rho}(
  x,
  title = "Spearman's rank correlation heatmap",
  low_color = "indianred1",
  high_color = "steelblue1",
  mid_color = "white",
  value_text_size = 4,
  ...
)
}
\arguments{
\item{data}{A numeric matrix or a data frame with at least two numeric
columns. All non-numeric columns will be excluded. Each column must have
at least two non-missing values and contain no NAs.}

\item{x}{An object of class \code{spearman_rho}.}

\item{digits}{Integer; number of decimal places to print in the concordance}

\item{max_rows}{Optional integer; maximum number of rows to display.
If \code{NULL}, all rows are shown.}

\item{max_cols}{Optional integer; maximum number of columns to display.
If \code{NULL}, all columns are shown.}

\item{...}{Additional arguments passed to \code{ggplot2::theme()} or other
\code{ggplot2} layers.}

\item{title}{Plot title. Default is \code{"Spearman's rank correlation
heatmap"}.}

\item{low_color}{Color for the minimum rho value. Default is
\code{"indianred1"}.}

\item{high_color}{Color for the maximum rho value. Default is
\code{"steelblue1"}.}

\item{mid_color}{Color for zero correlation. Default is \code{"white"}.}

\item{value_text_size}{Font size for displaying correlation values. Default
is \code{4}.}
}
\value{
A symmetric numeric matrix where the \code{(i, j)}-th element is
the Spearman correlation between the \code{i}-th and \code{j}-th
numeric columns of the input.

Invisibly returns the \code{spearman_rho} object.

A \code{ggplot} object representing the heatmap.
}
\description{
Computes all pairwise Spearman's rank correlation coefficients for the
numeric columns of a matrix or data frame using a high-performance
\code{C++} backend.

This function ranks the data and computes Pearson correlation on ranks,
which is equivalent to Spearmanâ€™s rho. It supports large datasets and
is optimized in C++ for performance.

Prints a summary of the Spearman's correlation matrix,
including description and method metadata.

Generates a ggplot2-based heatmap of the Spearman's rank
correlation matrix.
}
\details{
Spearman's correlation assesses how well the relationship between two
variables can be described using a monotonic function. It is computed by
ranking the data and then applying the Pearson correlation formula to the
ranks.
}
\note{
Missing values are not allowed. Columns with fewer than two
observations are excluded.
}
\examples{
mat <- cbind(a = rnorm(100), b = rnorm(100), c = rnorm(100))
sp <- spearman_rho(mat)
print(sp)
plot(sp)

\dontrun{
df <- data.frame(x = rnorm(1e4), y = rnorm(1e4), z = rnorm(1e4))
spearman_rho(df)

tied_df <- data.frame(
  v1 = rep(1:5, each = 20),
  v2 = rep(5:1, each = 20),
  v3 = rnorm(100)
)
sp <- spearman_rho(tied_df)
print(sp)
plot(sp)
}

}
\references{
Spearman, C. (1904). The proof and measurement of association between
two things. International Journal of Epidemiology, 39(5), 1137-1150.
}
\seealso{
\code{\link{print.spearman_rho}}, \code{\link{plot.spearman_rho}}
}
\author{
Thiago de Paula Oliveira \email{toliveira@abacusbio.com}

Thiago de Paula Oliveira
}
