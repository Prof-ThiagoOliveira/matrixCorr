% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/partial_correlation.R
\name{partial_correlation}
\alias{partial_correlation}
\alias{plot.partial_corr}
\title{Partial correlation matrix (sample / ridge / OAS)}
\usage{
partial_correlation(
  data,
  method = c("oas", "ridge", "sample"),
  lambda = 0.001,
  return_cov_precision = FALSE
)

\method{plot}{partial_corr}(
  x,
  title = NULL,
  low_color = "indianred1",
  high_color = "steelblue1",
  mid_color = "white",
  value_text_size = 4,
  mask_diag = TRUE,
  reorder = FALSE,
  ...
)
}
\arguments{
\item{data}{A numeric matrix or data frame with at least two numeric columns.
Non-numeric columns are ignored.}

\item{method}{Character; one of \code{"oas"}, \code{"ridge"}, \code{"sample"}.
Default \code{"oas"}.}

\item{lambda}{Numeric \eqn{\ge 0}; ridge penalty added to the covariance
diagonal when \code{method = "ridge"}. Ignored otherwise. Default \code{1e-3}.}

\item{return_cov_precision}{Logical; if \code{TRUE}, also return the
covariance (\code{cov}) and precision (\code{precision}) matrices used to
form the partial correlations. Default to \code{FALSE}}

\item{x}{An object of class \code{partial_corr}.}

\item{title}{Plot title. By default, constructed from the estimator in
\code{x$method}.}

\item{low_color}{Colour for low (negative) values. Default
\code{"indianred1"}.}

\item{high_color}{Colour for high (positive) values. Default
\code{"steelblue1"}.}

\item{mid_color}{Colour for zero. Default \code{"white"}.}

\item{value_text_size}{Font size for cell labels. Default \code{4}.}

\item{mask_diag}{Logical; if \code{TRUE}, the diagonal is masked
(set to \code{NA}) and not labelled. Default \code{TRUE}.}

\item{reorder}{Logical; if \code{TRUE}, variables are reordered by
hierarchical clustering of \eqn{1 - |pcor|}. Default \code{FALSE}.}

\item{...}{Additional arguments passed to \code{ggplot2::theme()} or other
\pkg{ggplot2} layers.}
}
\value{
An object of class \code{"partial_corr"} (a list) with elements:
\itemize{
\item \code{pcor}: \eqn{p \times p} partial correlation matrix.
\item \code{cov} (if requested): covariance matrix used.
\item \code{precision} (if requested): precision matrix \eqn{\Theta}.
\item \code{method}: the estimator used (\code{"oas"}, \code{"ridge"},
or \code{"sample"}).
\item \code{lambda}: ridge penalty (or \code{NA_real_}).
\item \code{rho}: OAS shrinkage weight in \eqn{[0,1]} (or \code{NA_real_}).
\item \code{jitter}: diagonal jitter added (if any) to ensure positive
definiteness.
}

A \code{ggplot} object.
}
\description{
Computes the Gaussian partial correlation matrix from a numeric data frame
or matrix, using one of three covariance estimators: unbiased sample
covariance, ridge-regularised covariance, or OAS shrinkage to a scaled
identity (recommended when \eqn{p \gg n}).

Produces a \pkg{ggplot2}-based heatmap of the partial correlation matrix
stored in \code{x$pcor}. Optionally masks the diagonal and/or reorders
variables via hierarchical clustering of \eqn{1 - |pcor|}.
}
\examples{
set.seed(1)
X <- matrix(rnorm(2000), nrow = 100, ncol = 20)
pc <- partial_correlation(X, method = "oas")
print(pc, digits = 2)
plot(pc)

}
\references{
Chen, Y., Wiesel, A., & Hero, A. O. III (2011).
Robust Shrinkage Estimation of High-dimensional Covariance Matrices.
IEEE Transactions on Signal Processing.
}
