% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pearson_corr.R
\name{pearson_corr}
\alias{pearson_corr}
\alias{print.pearson_corr}
\alias{plot.pearson_corr}
\title{Fast pairwise Pearson correlation}
\usage{
pearson_corr(data)

\method{print}{pearson_corr}(x, digits = 3, max_rows = NULL, max_cols = NULL, ...)

\method{plot}{pearson_corr}(
  x,
  title = "Pearson correlation heatmap",
  low_color = "indianred1",
  high_color = "steelblue1",
  mid_color = "white",
  value_text_size = 4,
  ...
)
}
\arguments{
\item{data}{A numeric matrix or a data frame with at least two numeric
columns. All non-numeric columns will be excluded. Each column must have
at least two non-missing values and contain no NAs.}

\item{x}{An object of class \code{pearson_corr}.}

\item{digits}{Integer; number of decimal places to print in the concordance}

\item{max_rows}{Optional integer; maximum number of rows to display.
If \code{NULL}, all rows are shown.}

\item{max_cols}{Optional integer; maximum number of columns to display.
If \code{NULL}, all columns are shown.}

\item{...}{Additional arguments passed to \code{ggplot2::theme()} or other
\code{ggplot2} layers.}

\item{title}{Plot title. Default is \code{"Pearson correlation heatmap"}.}

\item{low_color}{Color for the minimum correlation. Default is
\code{"indianred1"}.}

\item{high_color}{Color for the maximum correlation. Default is
\code{"steelblue1"}.}

\item{mid_color}{Color for zero correlation. Default is \code{"white"}.}

\item{value_text_size}{Font size for displaying correlation values. Default
is \code{4}.}
}
\value{
A symmetric numeric matrix where the \code{(i, j)}-th element is
the Pearson correlation between the \code{i}-th and \code{j}-th
numeric columns of the input.

Invisibly returns the \code{pearson_corr} object.

A \code{ggplot} object representing the heatmap.
}
\description{
Computes all pairwise Pearson correlation coefficients for the numeric
columns of a matrix or data frame using a high-performance \code{C++}
backend.

This function uses a direct Pearson formula implementation in C++ to achieve
fast and scalable correlation computations, especially for large datasets.

Prints a summary of the Pearson correlation matrix,
including description and method metadata.

Generates a ggplot2-based heatmap of the Pearson correlation
matrix.
}
\details{
Pearson's correlation measures the linear relationship between two variables.
It is defined as:

\deqn{ r = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i -
\bar{x})^2 \sum (y_i - \bar{y})^2}} }

This implementation avoids calculating means explicitly and instead
uses a numerically stable online form.
}
\note{
Missing values are not allowed. Columns with fewer than two
observations are excluded.
}
\examples{
mat <- cbind(a = rnorm(100), b = rnorm(100), c = rnorm(100))
pr <- pearson_corr(mat)
print(pr)
plot(pr)

\dontrun{
df <- data.frame(x = rnorm(1e4), y = rnorm(1e4), z = rnorm(1e4))
pearson_corr(df)
}

}
\references{
Pearson, K. (1895). "Notes on regression and inheritance in the case of
two parents". Proceedings of the Royal Society of London, 58, 240â€“242.
}
\seealso{
\code{\link{print.pearson_corr}}, \code{\link{plot.pearson_corr}}
}
\author{
Thiago de Paula Oliveira \email{toliveira@abacusbio.com}

Thiago de Paula Oliveira
}
